(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{223:function(e,t,n){},292:function(e,t,n){e.exports=n(444)},297:function(e,t,n){},442:function(e,t,n){},443:function(e,t,n){},444:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(43),i=n.n(o);n(297),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var c,l=n(33),u=n(146),s=(n(223),n(34)),m=n(111),d=function(e,t){console.log("Err value: ".concat(e,", result value : ").concat(t))},p=function(e){if(e.content.type&&"AdaptiveCard"===e.content.type){var t={height:void 0,width:600,title:e.preview.title,url:void 0,card:e.content,completionBotId:e.botId};s.tasks.startTask(t,d)}else alert("Could not load data, card type is not supported.")},g=function(e){return m.parseUrl(e).query.commandId},f=function(e){return e&&e.attachments?e.attachments.map(function(t){return function(e,t){var n="";return console.log(e),e.previewRawPayload.content.hasOwnProperty("images")&&e.previewRawPayload.content.images&&e.previewRawPayload.content.images[0]&&e.previewRawPayload.content.images[0].url&&(n=e.previewRawPayload.content.images[0].url),{contentType:"AdaptiveCard",content:e.card.content,preview:{title:e.previewRawPayload.content.title,subTitle:e.previewRawPayload.content.subtitle,text:e.previewRawPayload.content.text,heroImageSrc:n},botId:t}}(t,e.botId)}):[]},h=function(e){var t=document.createElement("div");return t.innerHTML=e,t.textContent||t.innerText||""},b=n(81),v=n(103),w=n(66),E=function(e,t,n){s.bot.sendQuery(e,t,n)},y=function(){var e=a.useState([]),t=Object(l.a)(e,2),n=t[0],r=t[1],o=a.useState(""),i=Object(l.a)(o,2),c=(i[0],i[1]),u=a.useState("JSONTabDefault"),m=Object(l.a)(u,2),d=m[0],p=m[1],g=function(e){alert(e)},f=function(e){r(e),s.appInitialization.notifySuccess()},h=function(e){var t;c(e.id),t=e.initialRun?"https://microsoft-teams-json-tab.azurewebsites.net?theme={theme}&frameContext=content&commandId=".concat(e.id,"&initialRun=").concat(e.initialRun):"https://microsoft-teams-json-tab.azurewebsites.net?theme={theme}&frameContext=content&commandId=".concat(e.id),s.settings.registerOnSaveHandler(function(e){s.settings.setSettings({entityId:"JSONTab",contentUrl:t,suggestedDisplayName:d}),e.notifySuccess()}),s.settings.setValidityState(!0)};return a.useEffect(function(){s.initialize(),s.appInitialization.notifyAppLoaded(),function(e,t){s.bot.getSupportedCommands(e,t)}(f,g)}),a.createElement("div",null,a.createElement("div",null,a.createElement(b.a,{size:"medium",content:"Name your tab"})),a.createElement(v.a,{fluid:!0,placeholder:"Tab name",onChange:function(e){p(e.target.value)}}),a.createElement("div",{style:{marginTop:"16px"}},a.createElement(b.a,{size:"medium",content:"Select the command you'd like query your bot with"})),a.createElement(w.a,{fluid:!0,items:n.map(function(e){return e.title}),noResultsMessage:"We couldn't find any matches.",onSelectedChange:function(e,t){var a=n.find(function(e){return e.title===t.value});a&&h(a)},placeholder:"Select the command"}))},C=n(47),k=n(46);!function(e){e.List="List",e.Grid="Grid"}(c||(c={}));var S,x=function(e){var t=r.a.useState(!0),n=Object(l.a)(t,2),a=n[0],o=n[1],i=function(t,n){e.onChange(n.value),o(n.value===c.List)};return r.a.createElement(C.a,{styles:e.styles,vAlign:"center"},r.a.createElement(C.a.Item,null,r.a.createElement(k.a,{icon:{name:"menu",outline:!a,size:"medium"},iconOnly:!0,text:!0,onClick:function(e){return i(0,{value:c.List})}})),r.a.createElement(C.a.Item,null,r.a.createElement(k.a,{icon:{name:"gallery",outline:a,size:"medium"},iconOnly:!0,text:!0,onClick:function(e){return i(0,{value:c.Grid})}})))},I=n(284);!function(e){e.List="List",e.Grid="Grid"}(S||(S={}));var L,z=function(e){var t=r.a.useState(""),n=Object(l.a)(t,2),a=n[0],o=n[1],i=Object(I.debounce)(e.onSearch,300);return r.a.createElement(C.a,{gap:"gap.small",vAlign:"center"},r.a.createElement(C.a.Item,{push:!0},r.a.createElement(C.a,null,r.a.createElement(x,{onChange:function(t){var n=t===S.List?S.List:S.Grid;e.onViewChange(n)},styles:{margin:"0 0 16px 0"}}))),r.a.createElement(v.a,{placeholder:"Search",icon:{name:"search",outline:!0},input:{styles:{width:"250px"}},styles:{margin:"0px 0px 16px 0px"},onChange:function(e){var t=e.currentTarget.value;e.currentTarget.value.length>=1?i(t):i(""),o(t)},onKeyPress:function(t){"Enter"===t.key&&e.onSearch(a)}}))},O=n(44),T=n(67),R=n(99),j=function(e){var t=0,n=e.itemList.map(function(e){return{key:++t,content:r.a.createElement(C.a,{vAlign:"center",fill:!0,gap:"gap.small"},r.a.createElement(C.a.Item,{styles:{width:"32px",height:"100%"}},r.a.createElement(O.a,{src:e.preview.heroImageSrc,className:"listItemImage"})),r.a.createElement(C.a.Item,{size:"size.medium"},r.a.createElement(b.a,{truncated:!0,size:"medium",weight:"semibold",content:h(e.preview.title)})),e.preview.subTitle?r.a.createElement(C.a.Item,{grow:!0,size:"size.medium"},r.a.createElement(b.a,{truncated:!0,size:"medium",weight:"regular",content:h(e.preview.subTitle)})):null,e.preview.text?r.a.createElement(C.a.Item,{grow:!0,size:"size.half"},r.a.createElement(b.a,{truncated:!0,size:"medium",weight:"regular",content:h(e.preview.text)})):null,r.a.createElement(T.a,{items:[],iconOnly:!0})," "),styles:{margin:"2px 2px 0 0"},onClick:function(){return p(e)}}});return r.a.createElement("div",null,r.a.createElement(R.a,{selectable:!0,items:n}))},W=n(144),A=n(145),V=n(449),B=function(e){var t=function(e){return Math.floor(e/278)},n=r.a.useState(t(window.innerWidth)),a=Object(l.a)(n,2),o=a[0],i=a[1],c=function(){i(t(window.innerWidth))};r.a.useEffect(function(){return window.addEventListener("resize",c),function(){window.removeEventListener("resize",c)}},[o]);return r.a.createElement("div",{style:{margin:"0 0 0 8px"}},r.a.createElement(A.a,{columns:o,accessibility:V.a,content:e.itemList.map(function(e){return r.a.createElement(W.a,{"data-is-focusable":"true",styles:{margin:"0 0 16px 12px",height:"146px",padding:"20px 20px 20px 20px",borderRadius:"3px",boxShadow:"0px 2px 4px -0.75px rgba(0,0,0,0.1)"},onClick:function(){return p(e)},onKeyPress:function(t){"Enter"===t.key&&p(e)}},r.a.createElement(C.a,{gap:"gap.small"},r.a.createElement(C.a.Item,null,r.a.createElement(O.a,{styles:{width:"48px",height:"100%"},src:e.preview.heroImageSrc,className:"listItemImage"})),r.a.createElement(C.a.Item,{size:"size.half",grow:!0},r.a.createElement(C.a,{column:!0,styles:{textAlign:"left"}},r.a.createElement(C.a.Item,{styles:{display:"-webkit-box",WebkitBoxOrient:"vertical",WebkitLineClamp:1,overflow:"hidden"}},r.a.createElement(b.a,{content:h(e.preview.title),styles:{margin:"0 0 2px 0"},size:"medium",weight:"bold"})),e.preview.subTitle?r.a.createElement(C.a.Item,{styles:{display:"-webkit-box",WebkitBoxOrient:"vertical",WebkitLineClamp:1,overflow:"hidden"}},r.a.createElement(b.a,{content:h(e.preview.subTitle),styles:{margin:"0 0 2px 0"},weight:"regular",size:"small"})):null,e.preview.text?r.a.createElement(C.a.Item,{grow:!0,size:"size.half",styles:{display:"-webkit-box",WebkitBoxOrient:"vertical",WebkitLineClamp:4,overflow:"hidden"}},r.a.createElement(b.a,{content:h(e.preview.text),weight:"regular",size:"small"})):null))))})}))};!function(e){e.List="List",e.Grid="Grid"}(L||(L={}));var P,N=function(e){return r.a.createElement("div",null,e.viewOption===L.List?r.a.createElement(j,{itemList:e.results}):r.a.createElement(B,{itemList:e.results}))},q=n(147),G=(n(442),function(e){return r.a.createElement("div",{className:"loadIcon"}," ",e.isLoading?r.a.createElement(q.a,null):null," ")}),D=(n(443),function(e){return r.a.createElement("div",{className:"ErrorView"},r.a.createElement(O.a,{styles:{maxWidth:"37%",margin:"0 auto",display:"block",textAlign:"center",marginBottom:"10px"},src:"error.svg"}),r.a.createElement(b.a,{size:"larger",content:"Hmm... Something went wrong..."}))}),H=function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement(b.a,{size:"large",content:e.title}),r.a.createElement(b.a,{size:"medium",content:r.a.createElement("p",null,"You'll need to ",r.a.createElement("a",{href:e.url},"sign in")," to use this app.")}))},U=n(38);!function(e){e.Loading="Loading",e.Error="Error",e.Render="Render",e.Auth="Auth"}(P||(P={}));var J,M=function(e){var t=r.a.useState("List"),n=Object(l.a)(t,2),a=n[0],o=n[1],i=r.a.useState([]),c=Object(l.a)(i,2),u=c[0],d=c[1],p=r.a.useState(P.Render),h=Object(l.a)(p,2),b=h[0],v=h[1],w=r.a.useState("Hmm... Something went wrong..."),y=Object(l.a)(w,2),C=y[0],k=y[1],S=r.a.useState({url:"",title:"Sign in"}),x=Object(l.a)(S,2),I=x[0],L=x[1],O=function(e){v(P.Error),k(e)},T=function(e){if(e.type===s.bot.ResponseType.Auth){var t=e.data;L({url:t.url,title:t.title}),v(P.Auth)}else{var n=e.data;d(f(n)),v(P.Render),s.appInitialization.notifySuccess()}};r.a.useEffect(function(){if(s.initialize(),s.appInitialization.notifyAppLoaded(),s.registerOnThemeChangeHandler(e.onThemeChange),function(){var e=m.parseUrl(window.location.href);return null!=e.query.initialRun&&"true"==e.query.initialRun}()){var t={query:"",commandId:g(window.location.href)};E(t,T,O),v(P.Loading)}},[e.onThemeChange]);var R=r.a.createElement(N,{results:u,viewOption:a});switch(b){case"Loading":R=r.a.createElement(G,{isLoading:!0});break;case"Error":R=r.a.createElement(D,{message:C});break;case"Auth":R=r.a.createElement(H,{title:I.title,url:I.url})}return r.a.createElement("div",{className:e.customClass},r.a.createElement(z,{onSearch:function(e){if(void 0!==e){var t={query:e,commandId:g(window.location.href)};E(t,T,O),v(P.Loading)}},onViewChange:function(e){e&&o(e)}}),R)},K=Object(U.createComponent)({displayName:"ContentViewWrapper",render:function(e){var t=e.stardust,n=e.onThemeChange,a=t.classes;return r.a.createElement(M,{customClass:a.root,onThemeChange:n})}}),F=function(e){var t,n=window.location.href;return"settings"===(t=n,m.parseUrl(t).query.frameContext)?r.a.createElement("div",null,r.a.createElement(y,null)):r.a.createElement(K,{onThemeChange:e.onThemeChange})},Q=n(23);!function(e){e.Dark="dark",e.Default="default",e.Contrast="contrast"}(J||(J={}));var Y=function(e){var t;switch(e){case J.Contrast:return t={componentVariables:{ContentViewWrapper:function(e){return{backgroundColor:e.colorScheme.default.background2}},ListItem:function(e){return{backgroundColor:e.colorScheme.default.background}},Segment:function(e){return{backgroundColor:e.colorScheme.default.background}},Input:function(e){return{inputBackgroundColor:e.colorScheme.default.background}}},componentStyles:{ContentViewWrapper:{root:function(e){return{backgroundColor:e.variables.backgroundColor}}},ListItem:{root:function(e){return{backgroundColor:e.variables.backgroundColor}}},Input:{input:function(e){return{backgroundColor:e.variables.inputBackgroundColor}}}}},Object(Q.a)(U.themes.teamsHighContrast,t);case J.Dark:return t={componentVariables:{ContentViewWrapper:function(e){return{backgroundColor:e.colorScheme.default.background2}},ListItem:function(e){return{backgroundColor:e.colorScheme.default.background}},Segment:function(e){return{backgroundColor:e.colorScheme.default.background}},Input:function(e){return{inputBackgroundColor:e.colorScheme.default.background}}},componentStyles:{ContentViewWrapper:{root:function(e){return{backgroundColor:e.variables.backgroundColor}}},ListItem:{root:function(e){return{backgroundColor:e.variables.backgroundColor}}},Input:{input:function(e){return{backgroundColor:e.variables.inputBackgroundColor}}}}},Object(Q.a)(U.themes.teamsDark,t);default:return t={componentVariables:{ContentViewWrapper:function(e){return{backgroundColor:e.colorScheme.default.background2}},ListItem:function(e){return{backgroundColor:e.colorScheme.default.background}},Segment:function(e){return{backgroundColor:e.colorScheme.default.background}},Input:function(e){return{inputBackgroundColor:e.colorScheme.default.background}}},componentStyles:{ContentViewWrapper:{root:function(e){return{backgroundColor:e.variables.backgroundColor}}},ListItem:{root:function(e){return{backgroundColor:e.variables.backgroundColor}}},Input:{input:function(e){return{backgroundColor:e.variables.inputBackgroundColor}}}}},Object(Q.a)(U.themes.teams,t)}};i.a.render(r.a.createElement(function(){var e=Y(function(e){var t=m.parseUrl(e).query.theme;return t||"default"}(window.location.href)),t=r.a.useState(e),n=Object(l.a)(t,2),a=n[0],o=n[1];return r.a.createElement(u.a,{theme:a},r.a.createElement(F,{onThemeChange:function(e){o(Y(e))}}))},null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[292,1,2]]]);
//# sourceMappingURL=main.c72e2a7a.chunk.js.map