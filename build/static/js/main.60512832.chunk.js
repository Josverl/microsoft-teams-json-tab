(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{128:function(e,t,n){},156:function(e,t,n){e.exports=n(192)},161:function(e,t,n){},162:function(e,t,n){},189:function(e,t,n){},190:function(e,t,n){},191:function(e,t,n){},192:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(23),o=n.n(i);n(161),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var c,l=n(24),s=n(72),u=(n(162),n(17)),m=n(63),d=function(e,t){console.log("Err value: ".concat(e,", result value : ").concat(t))},f=function(e){if(e.content.type&&"AdaptiveCard"===e.content.type){var t={height:void 0,width:void 0,title:e.preview.title,url:void 0,card:e.content,completionBotId:e.botId};u.tasks.startTask(t,d)}else alert("Could not load data, ".concat(e.content.type," is not supported."))},h=function(e){return m.parseUrl(e).query.commandId},p=function(){var e=m.parseUrl(window.location.href);return null!=e.query.initialRun&&"true"==e.query.initialRun},v=n(47),g=n(61),w=n(37),E=function(e,t,n){u.bot.sendQuery(e,t,n)},b=function(){var e=a.useState([]),t=Object(l.a)(e,2),n=t[0],r=t[1],i=a.useState(""),o=Object(l.a)(i,2),c=o[0],s=o[1],m=a.useState("JSONTabDefault"),d=Object(l.a)(m,2),f=d[0],h=d[1],E=function(e){alert(e)},b=function(e){r(e),u.appInitialization.notifySuccess()};return a.useEffect(function(){u.initialize(),u.appInitialization.notifyAppLoaded();var e=p()?"https://microsoft-teams-json-tab.azurewebsites.net?theme={theme}&frameContext=content&commandId=".concat(c):"https://microsoft-teams-json-tab.azurewebsites.net?theme={theme}&frameContext=content&commandId=".concat(c,"&initialRun=true");u.settings.registerOnSaveHandler(function(t){u.settings.setSettings({entityId:"JSONTab",contentUrl:e,suggestedDisplayName:f}),t.notifySuccess()}),function(e,t){u.bot.getSupportedCommands(e,t)}(b,E)}),a.createElement("div",null,a.createElement("div",null,a.createElement(v.a,{size:"medium",content:"Name your tab"})),a.createElement(g.a,{fluid:!0,placeholder:"Tab name",onChange:function(e){h(e.target.value)}}),a.createElement("div",null,a.createElement(v.a,{size:"medium",content:"Select the command you'd like query your bot with"})),a.createElement(w.a,{fluid:!0,items:n.map(function(e){return e.title}),noResultsMessage:"We couldn't find any matches.",onSelectedChange:function(e,t){var a=n.find(function(e){return e.title===t.value});s(a.id),u.settings.setValidityState(!0)},placeholder:"Select the command"}))},y=n(46),C=n.n(y),S=n(69),I=n(28),k=n(11),L=(n(128),n(136)),O=n(137),T=n(139),x=n(138),j=n(140);!function(e){e.List="List",e.Grid="Grid"}(c||(c={}));var N,R=function(e){function t(e){var n;return Object(L.a)(this,t),(n=Object(T.a)(this,Object(x.a)(t).call(this,e))).handleChange=function(){var e=Object(S.a)(C.a.mark(function e(t,a){return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.setState({highlighted:a.value});case 2:n.props.onChange(n.state.highlighted);case 3:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}(),n.state={highlighted:c.List},n}return Object(j.a)(t,e),Object(O.a)(t,[{key:"render",value:function(){var e=this,t={border:"none","box-shadow":"none"};return r.a.createElement("div",{className:"SearchBar",id:"buttons"},r.a.createElement(I.a,{icon:"menu",iconOnly:!0,onClick:function(t){return e.handleChange(t,{value:c.List})},styles:t}),r.a.createElement(I.a,{icon:"table",iconOnly:!0,onClick:function(t){return e.handleChange(t,{value:c.Grid})},styles:t}))}}]),t}(r.a.Component);!function(e){e.List="List",e.Grid="Grid"}(N||(N={}));var z,q,B=function(e){var t=r.a.useState(""),n=Object(l.a)(t,2),a=n[0],i=n[1],o=function(){var e=Object(S.a)(C.a.mark(function e(t){return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:i(t.target.value);case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),c=function(){var t=Object(S.a)(C.a.mark(function t(n){return C.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.onSearch(a);case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}();return r.a.createElement("div",{className:"SearchBar"},r.a.createElement(R,{onChange:function(t){var n=t===N.List?N.List:N.Grid;e.onViewChange(n)}}),r.a.createElement(g.a,{placeholder:"Search...",icon:function(){return r.a.createElement(I.a,{iconOnly:!0,icon:function(){return r.a.createElement(k.a,{name:"search",styles:{color:"black"}})},primary:!0,onClick:function(e){return c(e)},styles:{backgroundColor:"none",border:"none","box-shadow":"none","border-radius":"none"}})},input:{styles:{backgroundColor:"white"}},onChange:function(e){return o(e)},onKeyPress:function(t){"Enter"===t.key&&e.onSearch(a)}}),r.a.createElement("br",null))},D=n(29),G=n(26),H=n(59),A=function(e){var t=0,n=e.itemList.map(function(e){return{key:++t,content:r.a.createElement(D.a,{vAlign:"center"},r.a.createElement(D.a.Item,{styles:{width:"32px",height:"32px"}},r.a.createElement(G.a,{src:e.preview.heroImageSrc,className:"listItemImage"})),r.a.createElement(D.a.Item,null,r.a.createElement("span",{dangerouslySetInnerHTML:{__html:e.preview.title},className:"listItemTitle"})),e.preview.subTitle?r.a.createElement(D.a.Item,null,r.a.createElement("span",{dangerouslySetInnerHTML:{__html:e.preview.subTitle},className:"listItemDescription"})):null),className:"listItem",onClick:function(){return f(e)}}});return r.a.createElement("div",null,r.a.createElement(H.a,{selectable:!0,items:n}))},P=n(10),U=n(58),J=n(71),V=function(e){var t=e.preview;return a.createElement("div",{tabIndex:0,className:"CardBox",onClick:function(){return f(e)},onKeyDown:function(t){"Enter"===t.key?f(e):"Escape"===t.key&&document.getElementById("CardsContainer").focus()}},a.createElement(U.a,{vertical:!0,start:a.createElement("div",{id:"parent"},a.createElement(G.a,{className:"heroImage",src:t.heroImageSrc,circular:!0,styles:{width:"75px",height:"75px"}}),a.createElement(J.a,{className:"Title",as:"h4",content:t.title})),main:a.createElement("span",{className:"Subtitle"},a.createElement(v.a,{content:t.subTitle})),gap:"2px"}))},W=(n(189),function(e){for(var t,n,a=[],i=0;i<e.itemList.length;i++){var o=e.itemList[i];if(o.preview.title=o.preview.title.replace(/<[^>]*>?/gm,"").replace(/&nbsp;/gm,"").replace(/&quot;/gm,""),o.preview.subTitle&&(o.preview.subTitle=o.preview.subTitle.replace(/<[^>]*>?/gm,"").replace(/&nbsp;/gm,"").replace(/&quot;/gm,"")),t=o.preview.subTitle,(n=o.preview.title).length>21){var c=n.substring(0,21).concat("...");o.preview.title=c}t&&t.length>170&&(o.preview.subTitle=t.substring(0,170).concat("..."));var l=r.a.createElement(P.a,{key:i,content:V(o)});a.push(l)}return r.a.createElement("div",{className:"CardsContainer",id:"CardsContainer",tabIndex:1},a)});(q=z||(z={})).List="List",q.Grid="Grid";var _,M=function(e){return r.a.createElement("div",null,e.viewOption===z.List?r.a.createElement(A,{itemList:e.results}):r.a.createElement(W,{itemList:e.results}))},K=n(73),Q=(n(190),function(e){return r.a.createElement("div",{className:"loadIcon"}," ",e.isLoading?r.a.createElement(K.a,null):null," ")}),$=(n(191),function(e){return r.a.createElement("div",{className:"ErrorView"},r.a.createElement(G.a,{styles:{maxWidth:"37%",margin:"0 auto",display:"block",textAlign:"center",marginBottom:"10px"},src:"error.svg"}),r.a.createElement(v.a,{size:"larger",content:"Hmm... Something went wrong..."}))});!function(e){e.Loading="Loading",e.Error="Error",e.Render="Render"}(_||(_={}));var F,X=function(e){var t=r.a.useState("List"),n=Object(l.a)(t,2),a=n[0],i=n[1],o=r.a.useState([]),c=Object(l.a)(o,2),s=c[0],m=c[1],d=r.a.useState(_.Render),f=Object(l.a)(d,2),v=f[0],g=f[1],w=r.a.useState("Hmm... Something went wrong..."),b=Object(l.a)(w,2),y=b[0],C=b[1],S=function(e){g(_.Error),C(e)},I=function(e){m(function(e){return e&&e.attachments?e.attachments.map(function(t){return function(e,t){var n="";return e.previewRawPayload.content.hasOwnProperty("images")&&(n=e.previewRawPayload.content.images[0].url),{contentType:"AdaptiveCard",content:e.card.content,preview:{title:e.previewRawPayload.content.title,subTitle:e.previewRawPayload.content.text,heroImageSrc:n},botId:t}}(t,e.botId)}):[]}(e)),g(_.Render),u.appInitialization.notifySuccess()};r.a.useEffect(function(){if(u.initialize(),u.appInitialization.notifyAppLoaded(),u.registerOnThemeChangeHandler(e.onThemeChange),p()){var t={query:"",commandId:h(window.location.href)};E(t,I,S)}},[e.onThemeChange]);var k=r.a.createElement(M,{results:s,viewOption:a});return v===_.Loading?k=r.a.createElement(Q,{isLoading:!0}):v===_.Error&&(k=r.a.createElement($,{message:y})),r.a.createElement("div",null,r.a.createElement(B,{onSearch:function(e,t){if(void 0!==e){var n={query:e,commandId:h(window.location.href)};E(n,I,S),g(_.Loading)}},onViewChange:function(e){e&&i(e)}}),k)},Y=function(e){var t,n=window.location.href;return"settings"===(t=n,m.parseUrl(t).query.frameContext)?r.a.createElement("div",null,r.a.createElement(b,null)):r.a.createElement("div",null,r.a.createElement(X,{onThemeChange:e.onThemeChange}))},Z=n(21);!function(e){e.Dark="dark",e.Default="default",e.Contrast="contrast"}(F||(F={}));var ee=function(e){var t=Z.a.teams;switch(e){case F.Contrast:return Z.a.teamsHighContrast;case F.Dark:return Z.a.teamsDark}return t};o.a.render(r.a.createElement(function(){var e=ee(function(e){var t=m.parseUrl(e).query.theme;return t||"default"}(window.location.href)),t=r.a.useState(e),n=Object(l.a)(t,2),a=n[0],i=n[1];return r.a.createElement(s.a,{theme:a},r.a.createElement(Y,{onThemeChange:function(e){i(ee(e))}}))},null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[156,1,2]]]);
//# sourceMappingURL=main.60512832.chunk.js.map