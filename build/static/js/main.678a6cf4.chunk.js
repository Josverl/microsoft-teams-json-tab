(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{121:function(e,t,n){},157:function(e,t,n){e.exports=n(191)},162:function(e,t,n){},163:function(e,t,n){},190:function(e,t,n){},191:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(22),c=n.n(i);n(162),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var o,s=n(42),l=n(43),u=n(48),h=n(44),d=n(47),m=n(76),p=(n(163),n(29)),f=n.n(p),v=n(58),g=n(68),y=n(66),w=n(27),b=n(10);n(121);!function(e){e.List="List",e.Grid="Grid"}(o||(o={}));var C,E=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(u.a)(this,Object(h.a)(t).call(this,e))).handleChange=function(){var e=Object(v.a)(f.a.mark(function e(t,a){return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.setState({highlighted:a.value});case 2:n.props.onChange(n.state.highlighted);case 3:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}(),n.state={highlighted:o.List},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this,t={border:"none","box-shadow":"none"};return r.a.createElement("div",{className:"SearchBar",id:"buttons"},r.a.createElement(w.a,{icon:"bullets",iconOnly:!0,onClick:function(t){return e.handleChange(t,{value:o.List})},styles:t}),r.a.createElement(w.a,{icon:"calendar",iconOnly:!0,onClick:function(t){return e.handleChange(t,{value:o.Grid})},styles:t}))}}]),t}(r.a.Component);!function(e){e.List="List",e.Grid="Grid"}(C||(C={}));var O,k,j=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(u.a)(this,Object(h.a)(t).call(this,e))).handleRadioButtonChange=function(){var e=Object(v.a)(f.a.mark(function e(t){return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.setState({viewOption:n.getViewOption(t)});case 2:n.props.onViewChange(n.state.viewOption);case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),n.getViewOption=function(e){var t=C.List;return e===C.Grid&&(t=C.Grid),t},n.handleKeyPress=function(e){"Enter"===e.key&&n.props.onSearch(n.state.query)},n.state={query:"",viewOption:C.List},n.getViewOption.bind(Object(g.a)(n)),n.handleRadioButtonChange.bind(Object(g.a)(n)),n.handleKeyPress.bind(Object(g.a)(n)),n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"handleOnChange",value:function(e){this.setState({query:e.target.value})}},{key:"handleOnClick",value:function(e){this.props.onSearch(this.state.query)}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"SearchBar"},r.a.createElement(E,{onChange:this.handleRadioButtonChange}),r.a.createElement(y.a,{placeholder:"Search...",icon:function(){return r.a.createElement(w.a,{iconOnly:!0,icon:function(){return r.a.createElement(b.a,{name:"search",styles:{color:"black"}})},primary:!0,onClick:function(t){return e.handleOnClick(t)},styles:{backgroundColor:"none",border:"none","box-shadow":"none","border-radius":"none"}})},input:{styles:{backgroundColor:"white"}},onChange:function(t){return e.handleOnChange(t)},onKeyPress:this.handleKeyPress}),r.a.createElement("br",null))}}]),t}(r.a.Component),S=n(28),I=n(24),x=n(51),T=n(64),L=n(18),N=n(81),q=function(e,t){console.log("Err value: ".concat(e,", result value : ").concat(t))},R=function(e){if(e.content.type&&"AdaptiveCard"===e.content.type){var t={height:void 0,width:void 0,title:e.preview.heroImageSrc,url:void 0,card:e.content,completionBotId:"300639bf-2c0f-41a7-aa2e-7833664c4c76"};L.tasks.startTask(t,q)}else alert("Could not load data, ".concat(e.content.type," is not supported."))},B=function(e){var t="";e.previewRawPayload.content.hasOwnProperty("images")&&(t=e.previewRawPayload.content.images[0].url);return{contentType:"AdaptiveCard",content:e.card.content,preview:{title:e.previewRawPayload.content.title,subTitle:e.previewRawPayload.content.text,heroImageSrc:t}}},z=function(e){return e&&e.attachments?e.attachments.map(B):[]},D=function(e){var t=0,n=e.itemList.map(function(e){return{key:++t,content:r.a.createElement(S.a,{vAlign:"center"},r.a.createElement(S.a.Item,{styles:{width:"32px",height:"32px"}},r.a.createElement(I.a,{src:e.preview.heroImageSrc,className:"listItemImage"})),r.a.createElement(S.a.Item,null,r.a.createElement(x.a,{content:e.preview.title,className:"listItemTitle"})),e.preview.subTitle?r.a.createElement(S.a.Item,null,r.a.createElement(x.a,{content:e.preview.subTitle,className:"listItemDescription"})):null),className:"listItem",onClick:function(){return R(e)}}});return r.a.createElement("div",null,r.a.createElement(T.a,{selectable:!0,items:n}))},G=n(11),P=n(63),V=n(75),A=function(e){var t=e.preview;return a.createElement("div",{tabIndex:0,className:"CardBox",onClick:function(){return R(e)},onKeyDown:function(t){"Enter"===t.key?R(e):"Escape"===t.key&&document.getElementById("CardsContainer").focus()}},a.createElement(P.a,{vertical:!0,start:a.createElement("div",{id:"parent"},a.createElement(I.a,{className:"heroImage",src:t.heroImageSrc,circular:!0,styles:{width:"75px",height:"75px"}}),a.createElement(V.a,{className:"Title",as:"h4",content:t.title})),main:a.createElement("span",{className:"Subtitle"},a.createElement(x.a,{content:t.subTitle})),gap:"2px"}))},K=(n(190),function(e){for(var t,n,a=[],i=0;i<e.itemList.length;i++){var c=e.itemList[i];if(t=c.preview.subTitle,(n=c.preview.title).length>21){var o=n.substring(0,21).concat("...");c.preview.title=o}if(t&&t.length>170){var s=t.substring(0,170).concat("...");c.preview.subTitle=s}var l=r.a.createElement(G.a,{key:i,content:A(c)});a.push(l)}return r.a.createElement("div",{className:"CardsContainer",id:"CardsContainer",tabIndex:1},a)});(k=O||(O={})).List="List",k.Grid="Grid";var H,J=function(e){return r.a.createElement("div",null,e.viewOption===O.List?r.a.createElement(D,{itemList:e.results}):r.a.createElement(K,{itemList:e.results}))},U=[{title:"queryCards",id:"queryCards"},{title:"queryAdaptiveCards",id:"queryAdaptiveCards"},{title:"queryHeroCards",id:"queryAdaptiveCards"}],W=function(e,t,n){L.bot.sendQuery({query:e},t,n)},F=n(82),M=n(37),Q=function(e){var t=a.useState([]),n=Object(F.a)(t,2),r=n[0],i=n[1],c=a.useState(""),o=Object(F.a)(c,2),s=o[0],l=o[1],u=a.useState("JSONTabDefault"),h=Object(F.a)(u,2),d=h[0],m=h[1],p=function(e){i(e)},g=function(){var e=Object(v.a)(f.a.mark(function e(t){return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m(t.target.value);case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),w=function(){var e=Object(v.a)(f.a.mark(function e(t,n){return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l(n.value);case 2:L.settings.setValidityState(!0);case 3:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}();a.useEffect(function(){L.initialize(),L.settings.registerOnSaveHandler(function(e){L.settings.setSettings({entityId:"JSONTab",contentUrl:"https://microsoft-teams-json-tab.azurewebsites.net?theme={theme}&frameContext=content&commandId=".concat(s),suggestedDisplayName:d}),e.notifySuccess()}),p(U)});var b=r.map(function(e){return e.title});return a.createElement("div",null,a.createElement(x.a,{size:"smaller",content:"Name your tab"}),a.createElement(y.a,{fluid:!0,placeholder:"Tab name",onChange:function(e){return g(e)}}),a.createElement("br",null),a.createElement(x.a,{size:"smaller",content:"Select the command you'd like query your bot with"}),a.createElement(M.a,{fluid:!0,items:b,noResultsMessage:"We couldn't find any matches.",onSelectedChange:w}))},$=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(u.a)(this,Object(h.a)(t).call(this,e))).handleSearch=function(e,t){void 0!==e&&W(e,n.onResults,n.onError)},n.handleViewChange=function(e){e&&n.setState({viewOption:e})},n.onResults=function(e){n.setState({results:z(e)}),L.appInitialization.notifySuccess()},n.state={viewOption:"List",results:[]},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){L.initialize(),L.registerOnThemeChangeHandler(this.props.onThemeChange),L.appInitialization.notifyAppLoaded(),W("",this.onResults,this.onError)}},{key:"onError",value:function(e){L.appInitialization.notifyFailure({reason:L.appInitialization.FailedReason.Other,message:e}),alert(e)}},{key:"render",value:function(){var e,t=window.location.href;return"settings"===(e=t,N.parseUrl(e).query.frameContext)?r.a.createElement("div",null,r.a.createElement(Q,null)):r.a.createElement("div",null,r.a.createElement(j,{onSearch:this.handleSearch,onViewChange:this.handleViewChange}),r.a.createElement(J,{results:this.state.results,viewOption:this.state.viewOption}))}}]),t}(r.a.Component),X=n(26);!function(e){e.Dark="dark",e.Default="default",e.Contrast="contrast"}(H||(H={}));var Y=function(e){var t=N.parseUrl(e).query.theme;return t||"default"},Z=function(e){var t=X.a.teams;switch(e){case H.Contrast:return X.a.teamsHighContrast;case H.Dark:return X.a.teamsDark}return t},_=function(e){function t(e){var n;Object(s.a)(this,t),(n=Object(u.a)(this,Object(h.a)(t).call(this,e))).handleThemeChange=function(e){n.setState({currentTheme:Z(e)})};var a=window.location.href,r=Y(a);return n.state={currentTheme:Z(r)},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement(m.a,{theme:this.state.currentTheme},r.a.createElement($,{onThemeChange:this.handleThemeChange}))}}]),t}(r.a.Component);c.a.render(r.a.createElement(_,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[157,1,2]]]);
//# sourceMappingURL=main.678a6cf4.chunk.js.map